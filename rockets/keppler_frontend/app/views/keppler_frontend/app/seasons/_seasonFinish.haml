!!!
%html{:lang => "en"}
  %head
    %meta{:content => "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}/
    %meta{:charset => "utf-8"}/
    %title 
    // %script{:src => "https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js"}
    %script{:src => "https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.0/Chart.min.js"}
  %body
    .app_wrapper

      -# .d-flex.justify-content-between
        .float-left.mb-4{ style: 'width: 80%' }
          %h1
            #{@season.name}
            %label.badge (#{@season.type_name})
        .right.mt-4.mb-4
          %button.btn.btn_custom.btn--filled.btn--medium
            %i.icofont-clip-board
            Reporte
      .row
        .col-lg-12
          .card_show
            %h1.text-center Efectividad de la temporada
            %canvas#efectivity-chart{ height: "150", width: "400"}
            // %canvas#buyers{ height: "400", width: "1150"}
        .col-lg-12
          %h1.mb-4{style:"text-transform: uppercase"} Procesos
          .row
            .col-lg-6.col-md-6
              .card_show
                .text-center
                  %h3{style: "font-weight: 600;"} Celos
                  %h4 Cantidad de vacas
                %canvas#celo-chart{ height: "150", width: "250"}
            .col-lg-6.col-md-6
              .card_show
                .text-center
                  %h3{style: "font-weight: 600;"} Servicios
                  %h4 Cantidad vacas
                %canvas#services-chart{ height: "150", width: "250"}
            -# .col-lg-4
              .card_show
                .text-center
                  %h3{style: "font-weight: 600;"} Preñadas
                  %h4 Cantidad vacas
                %canvas#pregnancy-chart{ height: "150", width: "250"}
            -# .col-lg-3
              .card_show
                .text-center
                  %h3{style: "font-weight: 600;"} Parto
                  %h4 Cantidad vacas
                %canvas#parto-chart{ height: "150", width: "250"}
            -# .col-lg-4
              .card_show
                .text-center
                  %h3{style: "font-weight: 600;"} Abortos
                  %h4 Cantidad vacas
                %canvas#aborto-chart{ height: "150", width: "250"}
          %h1.mb-4{style:"text-transform: uppercase"} Responsables
          .row
            - @season.users.each do |responsable|
              - unless responsable.pregnants.count.zero? || responsable.name.blank?
                .col-lg-6.col-md-6
                  .card_show{style:"min-height: 254px;"}
                    .container-profile.mt-4
                      .profile.d-flex
                        .profile-img.d-none.d-sm-block
                          %img{src:"https://images.pexels.com/photos/433635/pexels-photo-433635.jpeg?cs=srgb&dl=adult-care-cure-433635.jpg&fm=jpg", alt:""}
                        .content-profile.ml-4{style: "width:100%"}
                          %strong.name= responsable.name
                          .count-cow.d-flex.justify-content-around
                            %div.d-flex.flex-column{style: "width:50%"}
                              %span
                                Preñadas
                              %span
                                #{responsable.pregnants.count}
                            %div.d-flex.flex-column{style: "width:31%"}
                              %span
                                Vacias
                              %span
                                #{responsable.inefectivities.count}
                            %div.d-flex.flex-column{style: "width:33%"}
                              %span
                                Efectividad
                              %span
                                #{(((responsable.pregnants.count.to_f) / (responsable.pregnants.count.to_f + responsable.inefectivities.count.to_f)) * 100).round(2)}%
                    %canvas{ id: "responsable-#{responsable.id}-chart", height: "95", width: "250"}
:scss
  .profile-img {
    img{
      width:70px;
      height:70px; 
      border-radius: 50%;
      object-fit: cover;
    }  
  }
  .content-profile {
    .name {
      font-size: 17px
    }
    .count-cow{
      font-size: 15px;
    }
  }
:javascript
  // Efectividad
  var bar_ctx = document.getElementById('efectivity-chart').getContext('2d');
  var green_gradient = bar_ctx.createLinearGradient(0, 0, 0, 800);
  green_gradient.addColorStop(0, ' #4AC29A');
  green_gradient.addColorStop(1, '#3CD3AD');

  var orange_gradient = bar_ctx.createLinearGradient(0, 0, 0, 800);
  orange_gradient.addColorStop(0, '#f28d23');
  orange_gradient.addColorStop(1, '#f83600');

  var gray_gradient = bar_ctx.createLinearGradient(0, 0, 0, 800);
  gray_gradient.addColorStop(0, '#eef2f3');
  // gray_gradient.addColorStop(1, 'rgba(255, 255, 255, .5)');
  gray_gradient.addColorStop(1, '#8e9eab');

  var line_chart = new Chart(bar_ctx, {
      type: 'pie',
      data: {
          labels: ["Partos", "Abortos", "Sin preñar"],
          datasets: [{
              label: 'Vacas en celo',
              data: [
                #{@season.cows.select { |x| x.status&.status_type == 'Birth' && x.status.farm_id.eql?(@farm.id) && x.status.successfully }.count},
                #{@season.cows.select { |x| x.status&.status_type == 'Birth' && x.status.farm_id.eql?(@farm.id) && !x.status.successfully }.count },
                #{@season.cows.reject { |x| x.status&.status_type == 'Birth' && x.status.farm_id.eql?(@farm.id) }.count}
              ],
              backgroundColor: [
                green_gradient,
                orange_gradient,
                gray_gradient
              ],
              hoverBackgroundColor: [
                green_gradient,
                orange_gradient,
                gray_gradient
              ],
              hoverBorderWidth: 2
          }]
      },
      options: {
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero:true
                  }
              }]
          }
      }
  });

- zeals = @season.statuses.where(status_type: 'Zeal')
:javascript
  // zeals
  var celos_ctx = document.getElementById('celo-chart').getContext('2d');
  var green_gradient = celos_ctx.createLinearGradient(0, 0, 0, 450);
  green_gradient.addColorStop(0, ' #4AC29A');
  green_gradient.addColorStop(1, '#3CD3AD');
  // green_gradient.addColorStop(1, 'rgba(255, 255, 255, .5)');

  var celo_chart = new Chart(celos_ctx, {
      type: 'line',
      data: {
          labelString: '20',
          labels: #{raw @season.months_on_season.map { |month| @season.all_months[month.to_i - 1] }},
          datasets: [{
              data: #{raw @season.months_on_season.map { |month| zeals.select { |x| x.date&.month&.eql?(month.to_i)}.count }},
              backgroundColor: green_gradient,
              hoverBackgroundColor: green_gradient,
              hoverBorderWidth: 2
          }]
      },
      options: {
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero:true
                  }
              }]
          }
      }
  });

- services = @season.statuses.where(status_type: 'Service')
:javascript
  // Service
  var service_ctx = document.getElementById('services-chart').getContext('2d');
  var green_gradient = service_ctx.createLinearGradient(0, 0, 0, 450);
  green_gradient.addColorStop(0, ' #4AC29A');
  green_gradient.addColorStop(1, '#3CD3AD');

  var service_chart = new Chart(service_ctx, {
      type: 'line',
      data: {
          labels: #{raw @season.months_on_season.map { |month| @season.all_months[month.to_i - 1] }},
          datasets: [{
              data: #{raw @season.months_on_season.map { |month| services.select { |x| x.date&.month&.eql?(month.to_i)}.count }},
              backgroundColor: green_gradient,
              hoverBackgroundColor: [
                green_gradient,
                orange_gradient,
              ],
              hoverBorderWidth: 2
          }]
      },
      options: {
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero:true
                  }
              }]
          }
      }
  });

- @season.users.each do |responsable|
  - unless responsable.pregnants.count.zero? || responsable.name.blank?
    :javascript
      // responsable
      var responsable_ctx = document.getElementById('responsable-#{responsable.id}-chart').getContext('2d');
      var green_gradient = responsable_ctx.createLinearGradient(0, 0, 0, 450);
      green_gradient.addColorStop(0, ' #4AC29A');
      green_gradient.addColorStop(1, '#3CD3AD');

      var gray_gradient = bar_ctx.createLinearGradient(0, 0, 0, 800);
      gray_gradient.addColorStop(0, '#eef2f3');
      // gray_gradient.addColorStop(1, 'rgba(255, 255, 255, .5)');
      gray_gradient.addColorStop(1, '#8e9eab');

      var responsable_chart = new Chart(responsable_ctx, {
          type: 'pie',
          data: {
              labels: ["Acertados", "Errados"],
              datasets: [{
                  data: [#{responsable.pregnants.count}, #{responsable.inefectivities.count}],
                  backgroundColor:[ 
                    green_gradient,
                    gray_gradient,
                  ],
                  hoverBackgroundColor: [
                    green_gradient,
                    gray_gradient,
                  ],
                  hoverBorderWidth: 2
              }]
          },
          options: {
              scales: {
                  yAxes: [{
                      ticks: {
                          beginAtZero:true
                      }
                  }]
              }
          }
      });